<html>
	<head>
		<title>CS 280A Proj2 - Leo Huang</title>
		<link rel="stylesheet" href="styles.css">
	</head>
	<body>
		<section class="" id="title">
			<h1>CS 280A Project 2</h1>
			<h1>Fun with Filters and Frequencies</h1>
			<h2>Leo Huang</h2>
			<div class="image-card">
				<img class="no-square" src="img/part2-2/butter_bloop.jpg" alt="">
				<p class="caption">an interesting looking mistake while making <a href="#part2-2">hybrid images</a></p>
			</div>
		</section>

		<section class="" id="overview">
			<h3>Overview</h3>
			<p>
				This project explores various papers and methods that use frequencies and filters to process images. First, we explore the use of filters to find edges. Then, we attempt to blur and sharpen images using different frequency manipulation, and use those frequencies to generate hybrid images following the approach described in the SIGGRAPH <a href="http://olivalab.mit.edu/publications/OlivaTorralb_Hybrid_Siggraph06.pdf">2006 paper</a> by Oliva, Torralba, and Schyns. Finally, we explore multiresolution blending to create new images through the use of Gaussian and Laplacian stacks, following the approach described in the <a href="https://persci.mit.edu/pub_pdfs/spline83.pdf">1983 paper</a> by Burt and Adelson.
			</p>
		</section>

		<section class="" id="part1">
			<h3>Filtering and Convlutions</h3>
			<h4>Finite Difference Operator</h4>
			<p>
				Using simple finite difference kernels in the x, y direction to convolve with our cameraman image helps visualize the partial derivatives, which seemingly appear as edges. The gradient magnitude image can then be generated by combining the two partial derviative images together through squaring and rooting. More specifically, we combine the directional derivatives into a single vector and find the 2-norm like so: <code>np.sqrt(dx ** 2 + dy ** 2)</code>. The final binarized gradient image was created by setting all pixels above a certain tuned threshold equal to 1 and the rest to 0, further clarifying the edges.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part1/grad_dx.png" alt="">
					<p class="caption">partial derivative dx</p>
				</div>
				<div class="image-card">
					<img src="img/part1/grad_dy.png" alt="">
					<p class="caption">partial derivative dy</p>
				</div>
				<div class="image-card">
					<img src="img/part1/grad_mag.png" alt="">
					<p class="caption">gradient magnitude</p>
				</div>
				<div class="image-card">
					<img src="img/part1/grad_bin.png" alt="">
					<p class="caption">binarized gradient</p>
				</div>
			</div>
			<h4>Derivative of Gaussian (DoG) Filter</h4>
			<p>
				To find a less jagged edge definition, I applied a Gaussian filter to the image to blur some of the features, and then reapplied the previous steps. After blurring, the resulting edge image is much smoother, and produces cleaner edges. Compared to the previous unblurred image, the edges also seem to be thicker, possibly due to the filter thickening some of the edges in the image and removing some of the noise that was observed before.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part1/blur_dx.png" alt="">
					<p class="caption">partial derivative dx</p>
				</div>
				<div class="image-card">
					<img src="img/part1/blur_dy.png" alt="">
					<p class="caption">partial derivative dy</p>
				</div>
				<div class="image-card">
					<img src="img/part1/blur_mag.png" alt="">
					<p class="caption">gradient magnitude</p>
				</div>
				<div class="image-card">
					<img src="img/part1/blur_bin.png" alt="">
					<p class="caption">binarized gradient</p>
				</div>
			</div>
			<p>
				To demonstrate the associativity of convolutions and filters, we first convolve the partial derivative kernels with the Gaussian filter before applying them to the image to create a derivative of Gaussian filter (DoG). The result edge image verifies that the operation is the same, and essentially generates the same edge quality.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part1/DoG_dx.png" alt="">
					<p class="caption">partial derivative dx</p>
				</div>
				<div class="image-card">
					<img src="img/part1/DoG_dy.png" alt="">
					<p class="caption">partial derivative dy</p>
				</div>
				<div class="image-card">
					<img src="img/part1/DoG_mag.png" alt="">
					<p class="caption">gradient magnitude</p>
				</div>
				<div class="image-card">
					<img src="img/part1/DoG_bin.png" alt="">
					<p class="caption">binarized gradient</p>
				</div>
			</div>
		</section>

		<section class="" id="part2-1">
			<h3>Image Sharpening</h3>
			<h4>Approach</h4>
			<p>
				Many times, it is possible to sharpen a blurry image by strengthening high frequency features or details in the original image. To obtain the high frequency features, we can subtract the low frequency features from the original image. The low frequency features can be found by convolving the image with a Gaussian filter. However, overly emphasizing the high frequency features can also be destructive and make the image look noisy, so the strengthening needs to be tuned using an alpha value.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part2-1/taj_a0.jpg" alt="">
					<p class="caption">alpha = 0</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/taj_a1.jpg" alt="">
					<p class="caption">alpha = 1</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/taj_a2.jpg" alt="">
					<p class="caption">alpha = 2</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/taj_a2.jpg" alt="">
					<p class="caption">alpha = 4</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/taj_a16.jpg" alt="">
					<p class="caption">alpha = 16</p>
				</div>
			</div>
			<p>
				In the following example, we can observe that the image does indeed seem to gradually get sharper, as the higher frequency features such as the cat's fur are more pronounced. However, when alpha reaches 16, the image appears almost noisy due to the over strengthening of the high frequency details.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part2-1/cat_a0.png" alt="">
					<p class="caption">alpha = 0</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cat_a1.png" alt="">
					<p class="caption">alpha = 1</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cat_a2.png" alt="">
					<p class="caption">alpha = 2</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cat_a2.png" alt="">
					<p class="caption">alpha = 4</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cat_a16.png" alt="">
					<p class="caption">alpha = 16</p>
				</div>
			</div>
			<h4>Resharpening a Blurred Image</h4>
			<p>
				Evaluating the effectiveness of this method, we attempt to resharpen an originally sharp image that was blurred using a Gaussian filter. In the original image, we can clearly see the crumbs and cracks in the cookie, and post-filtering, the cookie seems blurry as expected. Using our sharpening method, we can achieve a similar image to the original, although subpar, using an alpha value of 2. Further increases in the alpha value only yield crummier images.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/cookie.jpg" alt="">
					<p class="caption">original image</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cookie_a0.jpg" alt="">
					<p class="caption">blurred image</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cookie_a2.jpg" alt="">
					<p class="caption">alpha = 2</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cookie_a8.jpg" alt="">
					<p class="caption">alpha = 8</p>
				</div>
				<div class="image-card">
					<img src="img/part2-1/cookie_a16.jpg" alt="">
					<p class="caption">alpha = 16</p>
				</div>
			</div>
		</section>

		<section class="" id="part2-2">
			<h3>Hybrid Images</h3>
			<h4>Approach</h4>
			<p>
				Following the approach described in the SIGGRAPH <a href="http://olivalab.mit.edu/publications/OlivaTorralb_Hybrid_Siggraph06.pdf">2006 paper</a>, hybrid images can be generated by combining the high frequencies of an image with the low frequences of another. This results in the higher frequencies being more visible at closer distances, while the lower frequencies dominate at farther viewing distances. In this section, I also experiment with the effects of incorporating the color elements from each image. Although overall color blending proved to be difficult, incorporating high frequency color did help to focus the attention to the high frequency features rather than the low frequency backgrounds. If the base colors of both images were similar, then adding the low frequency color helped enhance the overall image as it helped make the images at their respective viewing distances more pronounced.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/derek.jpg" alt="">
					<p class="caption">derek</p>
				</div>
				<div class="image-card">
					<img src="img/data/nutmeg.jpg" alt="">
					<p class="caption">nutmeg</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/derek_8_nutmeg_20.jpg" alt="">
					<p class="caption">high nutmeg + low derek</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/nutmeg_8_derek_20.jpg" alt="">
					<p class="caption">high derek + low nutmeg</p>
				</div>
			</div>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part2-2/derek_8_nutmeg_20.jpg" alt="">
					<p class="caption">both color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/derek_8_nutmeg_20_lcol.jpg" alt="">
					<p class="caption">low freq. color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/derek_8_nutmeg_20_hcol.jpg" alt="">
					<p class="caption">high freq. color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/derek_8_nutmeg_20_gray.jpg" alt="">
					<p class="caption">grayscale</p>
				</div>
			</div>
			<p>
				Taking a popular scene from Spider Man, I tried overlaying the two scenes where Peter is discovering his newly acquired vision. Due to the blue wall in the background, it ended up being better to remove the color entirely to not make the hand blue and confuse the subject of the image.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/tobey_no_glasses.jpeg" alt="">
					<p class="caption">no glasses</p>
				</div>
				<div class="image-card">
					<img src="img/data/tobey_glasses.jpeg" alt="">
					<p class="caption">glasses</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/no_10_glass_3.jpg" alt="">
					<p class="caption">low no + high glasses</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/glass_10_no_3.jpg" alt="">
					<p class="caption">low glasses + high no </p>
				</div>
			</div>
			<p>
				My favorite result, although not the most successful, was the hybrid image generated between a caterpillar and its evolved butterfly lifeform. I thought the concept would be cool to implement, and I couldn't really decide whether adding low frequency or high frequency color benefitted more, so I display all the variations. I was relatively satisfied with how the grayscale images turned out though.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part2-2/cat_7_fly_8.jpg" alt="">
					<p class="caption">low cater + high fly</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/cat_7_fly_8_lcol.jpg" alt="">
					<p class="caption">low freq. color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/cat_7_fly_8_hcol.jpg" alt="">
					<p class="caption">high freq. color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/cat_7_fly_8_gray.jpg" alt="">
					<p class="caption">grayscale</p>
				</div>
			</div>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part2-2/fly_5_cat_8.jpg" alt="">
					<p class="caption">low fly + high cater</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fly_5_cat_8_lcol.jpg" alt="">
					<p class="caption">low freq. color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fly_5_cat_8_hcol.jpg" alt="">
					<p class="caption">high freq. color</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fly_5_cat_8_gray.jpg" alt="">
					<p class="caption">grayscale</p>
				</div>
			</div>
			<p>
				The following Fourier transform graphs were produced using the combination of the low frequency butterfly image and the high frequency caterpillar image.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/part2-2/fft_butterfly.jpg" alt="">
					<p class="caption">butterfly fft</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fft_butterfly_filter.jpg" alt="">
					<p class="caption">butterfly lowpass fft</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fft_caterpillar.jpg" alt="">
					<p class="caption">caterpillar fft</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fft_caterpillar_filter.jpg" alt="">
					<p class="caption">caterpillar highpass fft</p>
				</div>
				<div class="image-card">
					<img src="img/part2-2/fft_hybrid.jpg" alt="">
					<p class="caption">hybrid fft</p>
				</div>
			</div>
		</section>

		<section class="" id="part2-3">
			<h3>Gaussian and Laplacian Stacks</h3>
			<h4>Approach</h4>
			<p>
				Next, we explore the implementation of Gaussian and Laplacian stacks to ultimately blend images together like the oraple example described in the <a href="https://persci.mit.edu/pub_pdfs/spline83.pdf">1983 paper</a>. Creating the Gaussian stack, we applied a Gaussian filter to the image an additional time at each layer of the stack. This results in an accumulative blurring effect as the stack grows deeper. The Laplacian stack is calculated by taking the difference between each layer of the Gaussian stack, effectively separating out each frequency level and its corresponding features in the image. Here, we recreate the outcomes of the 1983 paper to successfully visualzie the different frequency feature levels, and reproduce the oraple.
			</p>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-3/apple_l0.jpg" alt=""> -->
					<p class="caption">l = 0</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/amask_l0.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/omask_l0.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_l0.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_g_l0.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
			</div>
			<br/>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-3/apple_l2.jpg" alt=""> -->
					<p class="caption">l = 2</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/amask_l2.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/omask_l2.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_l2.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_g_l2.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
			</div>
			<br/>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-3/apple_l4.jpg" alt=""> -->
					<p class="caption">l = 4</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/amask_l4.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/omask_l4.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_l4.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_g_l4.jpg" alt="">
					<!-- <p class="caption">alpha = 0</p> -->
				</div>
			</div>
			<br/>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-3/apple.jpg" alt=""> -->
					<p class="caption">final construction</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/amask.jpg" alt="">
					<p class="caption">masked apple</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/omask.jpg" alt="">
					<p class="caption">masked orange</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple.jpg" alt="">
					<p class="caption">oraple</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple_g.jpg" alt="">
					<p class="caption">oraple (grayscale)</p>
				</div>
			</div>
		</section>

		<section class="" id="part2-4">
			<h3>Multiresolution Blending</h3>
			<h4>Approach</h4>
			<p>
				To implement multiresolution blending of images, we utilize the Laplacian stacks and combine them using a Gaussian stack of a chosen mask. The Gaussian stack of the mask blurs the edge within the mask, and helps blend the frequencies of each image. The blending was implemented in the following: <code> blend = left_lstack * mask_gstack + right_lstack * (1 - mask_gstack)</code>. Thus, the mask blurs the images' features at the edge boundaries, and allow for a clean blend between the images. In this section, I also explore the effect of grayscaling and color, but ultimately find the incorporation of color to be more appealing.
			</p>
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/apple.jpeg" alt="">
					<p class="caption">apple</p>
				</div>
				<div class="image-card">
					<img src="img/data/orange.jpeg" alt="">
					<p class="caption">orange</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/vert_mask.jpg" alt="">
					<p class="caption">mask</p>
				</div>
				<div class="image-card">
					<img src="img/part2-3/oraple.jpg" alt="">
					<p class="caption">oraple</p>
				</div>
			</div>
			<!-- <p>
				TEXT
			</p> -->
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/monument.jpg" alt="">
					<p class="caption">monument</p>
				</div>
				<div class="image-card">
					<img src="img/data/rocket.jpg" alt="">
					<p class="caption">rocket</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/monuket_mask.jpg" alt="">
					<p class="caption">mask</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/monuket.jpg" alt="">
					<p class="caption">monuket</p>
				</div>
			</div>
			<!-- <p>
				TEXT
			</p> -->
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/monument.jpg" alt="">
					<p class="caption">monument</p>
				</div>
				<div class="image-card">
					<img class="bot-align" src="img/data/campanile.jpg" alt="">
					<p class="caption">campanile</p>
				</div>
				<div class="image-card">
					<img class="bot-align" src="img/part2-4/wampanile_mask.jpg" alt="">
					<p class="caption">mask</p>
				</div>
				<div class="image-card">
					<img class="bot-align" src="img/part2-4/wampanile.jpg" alt="">
					<p class="caption">wampanile</p>
				</div>
			</div>
			<!-- <p>
				TEXT
			</p> -->
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/cat_eat.jpg" alt="">
					<p class="caption">cat</p>
				</div>
				<div class="image-card">
					<img src="img/data/squirrel.jpg" alt="">
					<p class="caption">squirrel</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cat_eat_squirrel_mask.jpg" alt="">
					<p class="caption">mask</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cat_eat_squirrel.jpg" alt="">
					<p class="caption">food</p>
				</div>
			</div>
			<!-- <p>
				TEXT
			</p> -->
			<div class="image-row">
				<div class="image-card">
					<img src="img/data/cookie.jpg" alt="">
					<p class="caption">cookie</p>
				</div>
				<div class="image-card">
					<img src="img/data/cookie2.jpg" alt="">
					<p class="caption">cookies</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cookie_cookie_mask.jpg" alt="">
					<p class="caption">mask</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cookie_cookie.jpg" alt="">
					<p class="caption">impostor</p>
				</div>
			</div>
			<h4>Laplacian Stack Analysis</h4>
			<p>
				For my favorite result, the w(ashington)ampanile, the following visualizations of the Laplacian stacks were produced.
			</p>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-4/monument.jpg" alt=""> -->
					<p class="caption">l = 0</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cmask_l0.jpg" alt="">
					<!-- <p class="caption">masked campanile</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/mmask_l0.jpg" alt="">
					<!-- <p class="caption">masked monument</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/wamp_l0.jpg" alt="">
					<!-- <p class="caption">wamp</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/wamp_g_l0.jpg" alt="">
					<!-- <p class="caption">wamp (grayscale)</p> -->
				</div>
			</div>
			<br/>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-4/monument.jpg" alt=""> -->
					<p class="caption">l = 2</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cmask_l2.jpg" alt="">
					<!-- <p class="caption">masked campanile</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/mmask_l2.jpg" alt="">
					<!-- <p class="caption">masked monument</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/wamp_l2.jpg" alt="">
					<!-- <p class="caption">wamp</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/wamp_g_l2.jpg" alt="">
					<!-- <p class="caption">wamp (grayscale)</p> -->
				</div>
			</div>
			<br/>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-4/monument.jpg" alt=""> -->
					<p class="caption">l = 4</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cmask_l4.jpg" alt="">
					<!-- <p class="caption">masked campanile</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/mmask_l4.jpg" alt="">
					<!-- <p class="caption">masked monument</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/wamp_l4.jpg" alt="">
					<!-- <p class="caption">wamp</p> -->
				</div>
				<div class="image-card">
					<img src="img/part2-4/wamp_g_l4.jpg" alt="">
					<!-- <p class="caption">wamp (grayscale)</p> -->
				</div>
			</div>
			<br/>
			<div class="image-row">
				<div class="image-card">
					<!-- <img src="img/part2-4/monument.jpg" alt=""> -->
					<p class="caption">final construction</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/cmask.jpg" alt="">
					<p class="caption">masked campanile</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/mmask.jpg" alt="">
					<p class="caption">masked monument</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/wampanile.jpg" alt="">
					<p class="caption">wampanile</p>
				</div>
				<div class="image-card">
					<img src="img/part2-4/wampanile_g.jpg" alt="">
					<p class="caption">wampanile (grayscale)</p>
				</div>
			</div>
		</section>

	</body>
</html>
